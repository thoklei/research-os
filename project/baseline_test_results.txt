============================= test session starts ==============================
platform darwin -- Python 3.13.2, pytest-8.3.5, pluggy-1.6.0 -- /Users/thomas/.pyenv/versions/3.13.2/envs/zeus/bin/python
cachedir: .pytest_cache
rootdir: /Users/thomas/Projects/hackathon/research-os/project
plugins: anyio-4.8.0, mock-3.14.1
collecting ... collected 325 items

src/test_atomic_generator.py::TestGridInitialization::test_grid_creates_16x16_array PASSED [  0%]
src/test_atomic_generator.py::TestGridInitialization::test_grid_initializes_with_background PASSED [  0%]
src/test_atomic_generator.py::TestGridInitialization::test_grid_uses_int_dtype PASSED [  0%]
src/test_atomic_generator.py::TestGridInitialization::test_grid_accepts_valid_colors PASSED [  1%]
src/test_atomic_generator.py::TestGridInitialization::test_grid_copy PASSED [  1%]
src/test_atomic_generator.py::TestObject::test_object_from_pixels PASSED [  1%]
src/test_atomic_generator.py::TestObject::test_object_size PASSED        [  2%]
src/test_atomic_generator.py::TestObject::test_object_bounds PASSED      [  2%]
src/test_atomic_generator.py::TestObject::test_object_translate PASSED   [  2%]
src/test_atomic_generator.py::TestObject::test_empty_object PASSED       [  3%]
src/test_atomic_generator.py::TestCollisionDetection::test_no_collision_on_empty_grid PASSED [  3%]
src/test_atomic_generator.py::TestCollisionDetection::test_collision_with_existing_object PASSED [  3%]
src/test_atomic_generator.py::TestCollisionDetection::test_no_collision_adjacent_cells PASSED [  4%]
src/test_atomic_generator.py::TestCollisionDetection::test_collision_with_multi_pixel_object PASSED [  4%]
src/test_atomic_generator.py::TestCollisionDetection::test_out_of_bounds_collision PASSED [  4%]
src/test_atomic_generator.py::TestPlacementEngine::test_successful_placement_on_empty_grid PASSED [  4%]
src/test_atomic_generator.py::TestPlacementEngine::test_placement_returns_valid_position PASSED [  5%]
src/test_atomic_generator.py::TestPlacementEngine::test_placement_fails_on_full_grid PASSED [  5%]
src/test_atomic_generator.py::TestPlacementEngine::test_place_object_on_grid PASSED [  5%]
src/test_atomic_generator.py::TestPlacementEngine::test_placement_respects_max_attempts PASSED [  6%]
src/test_atomic_generator.py::TestSizeConstraintValidation::test_valid_object_size_2_pixels PASSED [  6%]
src/test_atomic_generator.py::TestSizeConstraintValidation::test_valid_object_size_15_pixels PASSED [  6%]
src/test_atomic_generator.py::TestSizeConstraintValidation::test_valid_object_size_middle_range PASSED [  7%]
src/test_atomic_generator.py::TestSizeConstraintValidation::test_invalid_object_size_too_small PASSED [  7%]
src/test_atomic_generator.py::TestSizeConstraintValidation::test_invalid_object_size_too_large PASSED [  7%]
src/test_atomic_generator.py::TestSizeConstraintValidation::test_empty_object_fails_validation PASSED [  8%]
src/test_atomic_generator.py::TestSizeConstraintValidation::test_custom_size_constraints PASSED [  8%]
src/test_atomic_generator.py::TestIntegration::test_place_multiple_objects_without_collision PASSED [  8%]
src/test_atomic_generator.py::TestIntegration::test_full_pipeline_with_size_validation PASSED [  8%]
src/test_beta_vae.py::TestBetaVAEForward::test_forward_pass_shapes PASSED [  9%]
src/test_beta_vae.py::TestBetaVAEForward::test_forward_pass_no_nan PASSED [  9%]
src/test_beta_vae.py::TestBetaVAEForward::test_forward_pass_deterministic_in_eval PASSED [  9%]
src/test_beta_vae.py::TestReparameterization::test_reparameterize_shape PASSED [ 10%]
src/test_beta_vae.py::TestReparameterization::test_reparameterize_stochastic PASSED [ 10%]
src/test_beta_vae.py::TestReparameterization::test_reparameterize_respects_mu PASSED [ 10%]
src/test_beta_vae.py::TestReparameterization::test_reparameterize_gradients_flow PASSED [ 11%]
src/test_beta_vae.py::TestLossFunction::test_loss_function_components PASSED [ 11%]
src/test_beta_vae.py::TestLossFunction::test_loss_function_positive PASSED [ 11%]
src/test_beta_vae.py::TestLossFunction::test_loss_function_beta_effect PASSED [ 12%]
src/test_beta_vae.py::TestLossFunction::test_loss_function_perfect_reconstruction PASSED [ 12%]
src/test_beta_vae.py::TestLossFunction::test_loss_function_kl_divergence PASSED [ 12%]
src/test_beta_vae.py::TestSampling::test_sample_shape PASSED             [ 12%]
src/test_beta_vae.py::TestSampling::test_sample_produces_valid_logits PASSED [ 13%]
src/test_beta_vae.py::TestSampling::test_sample_stochastic PASSED        [ 13%]
src/test_beta_vae.py::TestSampling::test_sample_no_nan PASSED            [ 13%]
src/test_beta_vae.py::TestReconstruction::test_reconstruct_shape PASSED  [ 14%]
src/test_beta_vae.py::TestReconstruction::test_reconstruct_uses_mean PASSED [ 14%]
src/test_beta_vae.py::TestReconstruction::test_reconstruct_no_nan PASSED [ 14%]
src/test_beta_vae.py::TestEndToEnd::test_train_step PASSED               [ 15%]
src/test_beta_vae.py::TestEndToEnd::test_multiple_train_steps PASSED     [ 15%]
src/test_beta_vae.py::TestEndToEnd::test_eval_mode PASSED                [ 15%]
src/test_beta_vae.py::TestEndToEnd::test_save_load_model PASSED          [ 16%]
src/test_beta_vae.py::TestDifferentLatentDims::test_latent_dim_8 PASSED  [ 16%]
src/test_beta_vae.py::TestDifferentLatentDims::test_latent_dim_16 PASSED [ 16%]
src/test_blob_generator.py::TestBlobGeneration::test_blob_generator_creates_object PASSED [ 16%]
src/test_blob_generator.py::TestBlobGeneration::test_blob_respects_minimum_size PASSED [ 17%]
src/test_blob_generator.py::TestBlobGeneration::test_blob_respects_maximum_size PASSED [ 17%]
src/test_blob_generator.py::TestBlobGeneration::test_blob_size_in_valid_range PASSED [ 17%]
src/test_blob_generator.py::TestBlobGeneration::test_blob_size_randomness PASSED [ 18%]
src/test_blob_generator.py::TestBlobGeneration::test_blob_default_constraints PASSED [ 18%]
src/test_blob_generator.py::TestConnectivityBiasedGrowth::test_blob_starts_with_seed_pixel PASSED [ 18%]
src/test_blob_generator.py::TestConnectivityBiasedGrowth::test_blob_is_connected PASSED [ 19%]
src/test_blob_generator.py::TestConnectivityBiasedGrowth::test_blob_has_cohesive_shape PASSED [ 19%]
src/test_blob_generator.py::TestConnectivityBiasedGrowth::test_connectivity_bias_favors_dense_shapes PASSED [ 19%]
src/test_blob_generator.py::TestConnectivityBiasedGrowth::test_growth_terminates PASSED [ 20%]
src/test_blob_generator.py::TestBlobColorAssignment::test_color_sampled_from_palette PASSED [ 20%]
src/test_blob_generator.py::TestBlobColorAssignment::test_color_sampling_is_uniform PASSED [ 20%]
src/test_blob_generator.py::TestBlobColorAssignment::test_custom_palette PASSED [ 20%]
src/test_blob_generator.py::TestBlobShapeValidation::test_is_connected_single_pixel PASSED [ 21%]
src/test_blob_generator.py::TestBlobShapeValidation::test_is_connected_horizontal_line PASSED [ 21%]
src/test_blob_generator.py::TestBlobShapeValidation::test_is_connected_diagonal PASSED [ 21%]
src/test_blob_generator.py::TestBlobShapeValidation::test_is_connected_blob_shape PASSED [ 22%]
src/test_blob_generator.py::TestBlobShapeValidation::test_is_not_connected_separated_pixels PASSED [ 22%]
src/test_blob_generator.py::TestBlobShapeValidation::test_is_not_connected_two_groups PASSED [ 22%]
src/test_blob_generator.py::TestBlobBoundaryChecking::test_blob_fits_in_grid PASSED [ 23%]
src/test_blob_generator.py::TestBlobBoundaryChecking::test_blob_normalized_coordinates PASSED [ 23%]
src/test_blob_generator.py::TestBlobIntegration::test_generate_multiple_blobs PASSED [ 23%]
src/test_blob_generator.py::TestBlobIntegration::test_blob_generation_with_retry PASSED [ 24%]
src/test_cli.py::TestDirectoryStructure::test_create_dataset_directory PASSED [ 24%]
src/test_cli.py::TestDirectoryStructure::test_directory_naming_format PASSED [ 24%]
src/test_cli.py::TestDirectoryStructure::test_custom_version_naming PASSED [ 24%]
src/test_cli.py::TestDirectoryStructure::test_datasets_subdirectory PASSED [ 25%]
src/test_cli.py::TestDirectoryStructure::test_directory_already_exists PASSED [ 25%]
src/test_cli.py::TestCLIArgumentParsing::test_parse_args_default_values PASSED [ 25%]
src/test_cli.py::TestCLIArgumentParsing::test_parse_args_num_images PASSED [ 26%]
src/test_cli.py::TestCLIArgumentParsing::test_parse_args_output_dir PASSED [ 26%]
src/test_cli.py::TestCLIArgumentParsing::test_parse_args_seed PASSED     [ 26%]
src/test_cli.py::TestCLIArgumentParsing::test_parse_args_all_options PASSED [ 27%]
src/test_cli.py::TestMemoryEstimation::test_format_memory_estimate PASSED [ 27%]
src/test_cli.py::TestMemoryEstimation::test_memory_estimate_1k_images PASSED [ 27%]
src/test_cli.py::TestMemoryEstimation::test_memory_estimate_100k_images PASSED [ 28%]
src/test_cli.py::TestGenerationWorkflow::test_generate_small_dataset PASSED [ 28%]
src/test_cli.py::TestGenerationWorkflow::test_generated_dataset_valid PASSED [ 28%]
src/test_cli.py::TestGenerationWorkflow::test_metadata_matches_generation_params PASSED [ 28%]
src/test_cli.py::TestGenerationWorkflow::test_reproducible_with_seed PASSED [ 29%]
src/test_cli.py::TestErrorHandling::test_invalid_num_images PASSED       [ 29%]
src/test_cli.py::TestErrorHandling::test_negative_num_images PASSED      [ 29%]
src/test_cli.py::TestErrorHandling::test_nonexistent_output_dir_created PASSED [ 30%]
src/test_cli.py::TestIntegration::test_full_workflow_small_scale PASSED  [ 30%]
src/test_data_loading.py::TestARCDataset::test_dataset_load_all PASSED   [ 30%]
src/test_data_loading.py::TestARCDataset::test_dataset_getitem PASSED    [ 31%]
src/test_data_loading.py::TestARCDataset::test_dataset_with_splits PASSED [ 31%]
src/test_data_loading.py::TestARCDataset::test_dataset_get_batch PASSED  [ 31%]
src/test_data_loading.py::TestARCDataset::test_dataset_stats PASSED      [ 32%]
src/test_data_loading.py::TestDatasetWithSplits::test_dataset_with_splits_creation PASSED [ 32%]
src/test_data_loading.py::TestDatasetWithSplits::test_dataset_with_splits_stats PASSED [ 32%]
src/test_data_loading.py::TestTransforms::test_random_rotation PASSED    [ 32%]
src/test_data_loading.py::TestTransforms::test_random_rotation_preserves_values PASSED [ 33%]
src/test_data_loading.py::TestTransforms::test_horizontal_flip PASSED    [ 33%]
src/test_data_loading.py::TestTransforms::test_vertical_flip PASSED      [ 33%]
src/test_data_loading.py::TestTransforms::test_compose_transforms PASSED [ 34%]
src/test_data_loading.py::TestTransforms::test_identity_transform PASSED [ 34%]
src/test_data_loading.py::TestTransforms::test_get_train_transforms PASSED [ 34%]
src/test_data_loading.py::TestTransforms::test_transforms_preserve_dtype PASSED [ 35%]
src/test_data_loading.py::TestDataLoaders::test_create_single_data_loader PASSED [ 35%]
src/test_data_loading.py::TestDataLoaders::test_create_data_loaders PASSED [ 35%]
src/test_data_loading.py::TestDataLoaders::test_data_loader_batching PASSED [ 36%]
src/test_data_loading.py::TestDataLoaders::test_data_loader_iteration PASSED [ 36%]
src/test_data_loading.py::TestEndToEnd::test_full_pipeline_with_real_data PASSED [ 36%]
src/test_decoder.py::TestDecoderShapes::test_decoder_output_shapes PASSED [ 36%]
src/test_decoder.py::TestDecoderShapes::test_decoder_single_sample PASSED [ 37%]
src/test_decoder.py::TestDecoderShapes::test_decoder_large_batch PASSED  [ 37%]
src/test_decoder.py::TestDecoderShapes::test_decoder_different_latent_dims PASSED [ 37%]
src/test_decoder.py::TestDecoderOutputType::test_decoder_outputs_logits PASSED [ 38%]
src/test_decoder.py::TestDecoderOutputType::test_decoder_logits_vary_with_input PASSED [ 38%]
src/test_decoder.py::TestDecoderOutputType::test_decoder_logits_to_labels PASSED [ 38%]
src/test_decoder.py::TestDecoderInputValidation::test_decoder_accepts_zero_latent PASSED [ 39%]
src/test_decoder.py::TestDecoderInputValidation::test_decoder_accepts_standard_normal PASSED [ 39%]
src/test_decoder.py::TestDecoderInputValidation::test_decoder_accepts_extreme_values PASSED [ 39%]
src/test_decoder.py::TestDecoderGradients::test_decoder_gradients_flow PASSED [ 40%]
src/test_decoder.py::TestDecoderGradients::test_decoder_trainable_parameters PASSED [ 40%]
src/test_decoder.py::TestDecoderDeterminism::test_decoder_deterministic_in_eval PASSED [ 40%]
src/test_decoder.py::TestDecoderDeterminism::test_decoder_reproducible_with_seed PASSED [ 40%]
src/test_decoder.py::TestDecoderArchitecture::test_decoder_has_linear_layers PASSED [ 41%]
src/test_decoder.py::TestDecoderArchitecture::test_decoder_has_deconv_layers PASSED [ 41%]
src/test_decoder.py::TestDecoderArchitecture::test_decoder_has_conv_layers PASSED [ 41%]
src/test_decoder.py::TestDecoderArchitecture::test_decoder_output_reasonable_range PASSED [ 42%]
src/test_decoder.py::TestDecoderEncodeDecodeConsistency::test_encoder_decoder_compatible_shapes PASSED [ 42%]
src/test_decoder.py::TestDecoderEncodeDecodeConsistency::test_encode_decode_round_trip PASSED [ 42%]
src/test_encoder.py::TestEncoderShapes::test_encoder_output_shapes PASSED [ 43%]
src/test_encoder.py::TestEncoderShapes::test_encoder_single_sample PASSED [ 43%]
src/test_encoder.py::TestEncoderShapes::test_encoder_large_batch PASSED  [ 43%]
src/test_encoder.py::TestEncoderShapes::test_encoder_different_latent_dims PASSED [ 44%]
src/test_encoder.py::TestEncoderLatentDistribution::test_mu_is_continuous PASSED [ 44%]
src/test_encoder.py::TestEncoderLatentDistribution::test_logvar_is_continuous PASSED [ 44%]
src/test_encoder.py::TestEncoderLatentDistribution::test_mu_varies_with_input PASSED [ 44%]
src/test_encoder.py::TestEncoderLatentDistribution::test_logvar_varies_with_input PASSED [ 45%]
src/test_encoder.py::TestEncoderInputValidation::test_encoder_accepts_valid_colors PASSED [ 45%]
src/test_encoder.py::TestEncoderInputValidation::test_encoder_with_zeros PASSED [ 45%]
src/test_encoder.py::TestEncoderInputValidation::test_encoder_with_max_colors PASSED [ 46%]
src/test_encoder.py::TestEncoderGradients::test_encoder_gradients_flow PASSED [ 46%]
src/test_encoder.py::TestEncoderGradients::test_encoder_trainable_parameters PASSED [ 46%]
src/test_encoder.py::TestEncoderDeterminism::test_encoder_deterministic_in_eval PASSED [ 47%]
src/test_encoder.py::TestEncoderDeterminism::test_encoder_reproducible_with_seed PASSED [ 47%]
src/test_encoder.py::TestEncoderArchitecture::test_encoder_has_conv_layers PASSED [ 47%]
src/test_encoder.py::TestEncoderArchitecture::test_encoder_has_linear_layers PASSED [ 48%]
src/test_encoder.py::TestEncoderArchitecture::test_encoder_output_reasonable_range PASSED [ 48%]
src/test_integration.py::TestPipelineIntegration::test_1k_dataset_generation PASSED [ 48%]
src/test_integration.py::TestPipelineIntegration::test_1k_dataset_memory_estimate PASSED [ 48%]
src/test_integration.py::TestPipelineIntegration::test_1k_dataset_save_and_load PASSED [ 49%]
src/test_integration.py::TestPipelineIntegration::test_100k_dataset_memory_estimate PASSED [ 49%]
src/test_integration.py::TestPipelineIntegration::test_small_scale_end_to_end PASSED [ 49%]
src/test_integration.py::TestCLIIntegration::test_cli_help FAILED        [ 50%]
src/test_integration.py::TestCLIIntegration::test_cli_invalid_num_images PASSED [ 50%]
src/test_integration.py::TestCLIIntegration::test_cli_with_custom_parameters FAILED [ 50%]
src/test_integration.py::TestMemoryUsage::test_memory_stays_within_bounds_1k PASSED [ 51%]
src/test_integration.py::TestMemoryUsage::test_uint8_vs_int64_memory_savings PASSED [ 51%]
src/test_integration.py::TestReproducibility::test_same_seed_produces_identical_datasets PASSED [ 51%]
src/test_integration.py::TestReproducibility::test_different_seeds_produce_different_datasets PASSED [ 52%]
src/test_integration.py::TestDatasetQuality::test_dataset_values_in_valid_range PASSED [ 52%]
src/test_integration.py::TestDatasetQuality::test_dataset_has_variety PASSED [ 52%]
src/test_integration.py::TestDatasetQuality::test_dataset_not_all_zeros PASSED [ 52%]
src/test_integration.py::TestDatasetQuality::test_dataset_background_dominant PASSED [ 53%]
src/test_integration.py::TestVisualValidationIntegration::test_visual_validation_workflow PASSED [ 53%]
src/test_integration.py::TestVisualValidationIntegration::test_visual_validation_cli FAILED [ 53%]
src/test_integration.py::TestScaleValidation::test_validate_small_dataset PASSED [ 54%]
src/test_integration.py::TestScaleValidation::test_validate_medium_dataset PASSED [ 54%]
src/test_integration.py::TestScaleValidation::test_validate_large_dataset PASSED [ 54%]
src/test_large_scale_pipeline.py::TestMemoryEstimation::test_estimate_memory_1k_images PASSED [ 55%]
src/test_large_scale_pipeline.py::TestMemoryEstimation::test_estimate_memory_100k_images PASSED [ 55%]
src/test_large_scale_pipeline.py::TestMemoryEstimation::test_estimate_memory_int64_dtype PASSED [ 55%]
src/test_large_scale_pipeline.py::TestMemoryEstimation::test_estimate_memory_single_image PASSED [ 56%]
src/test_large_scale_pipeline.py::TestMemoryEstimation::test_estimate_memory_returns_tuple PASSED [ 56%]
src/test_large_scale_pipeline.py::TestMemoryEstimation::test_estimate_memory_different_dtypes PASSED [ 56%]
src/test_large_scale_pipeline.py::TestUint8Conversion::test_generate_corpus_uint8_dtype PASSED [ 56%]
src/test_large_scale_pipeline.py::TestUint8Conversion::test_generate_corpus_default_dtype PASSED [ 57%]
src/test_large_scale_pipeline.py::TestUint8Conversion::test_generate_corpus_int64_dtype PASSED [ 57%]
src/test_large_scale_pipeline.py::TestUint8Conversion::test_uint8_preserves_values PASSED [ 57%]
src/test_large_scale_pipeline.py::TestUint8Conversion::test_uint8_memory_savings PASSED [ 58%]
src/test_large_scale_pipeline.py::TestProgressTracking::test_generate_corpus_with_progress PASSED [ 58%]
src/test_large_scale_pipeline.py::TestProgressTracking::test_generate_corpus_without_progress PASSED [ 58%]
src/test_large_scale_pipeline.py::TestProgressTracking::test_progress_default_disabled PASSED [ 59%]
src/test_large_scale_pipeline.py::TestProgressTracking::test_progress_tracking_large_corpus PASSED [ 59%]
src/test_large_scale_pipeline.py::TestBackwardCompatibility::test_existing_demo_still_works PASSED [ 59%]
src/test_large_scale_pipeline.py::TestBackwardCompatibility::test_no_required_parameters_added PASSED [ 60%]
src/test_large_scale_pipeline.py::TestBackwardCompatibility::test_existing_visualizations_work PASSED [ 60%]
src/test_large_scale_pipeline.py::TestBackwardCompatibility::test_split_corpus_still_works PASSED [ 60%]
src/test_large_scale_pipeline.py::TestBackwardCompatibility::test_reproducibility_maintained PASSED [ 60%]
src/test_large_scale_pipeline.py::TestIntegration::test_full_workflow_with_uint8 PASSED [ 61%]
src/test_large_scale_pipeline.py::TestIntegration::test_memory_estimate_accuracy PASSED [ 61%]
src/test_large_scale_pipeline.py::TestIntegration::test_large_corpus_feasibility PASSED [ 61%]
src/test_large_scale_visualization.py::TestMetadataGeneration::test_create_metadata_basic PASSED [ 62%]
src/test_large_scale_visualization.py::TestMetadataGeneration::test_create_metadata_includes_timestamp PASSED [ 62%]
src/test_large_scale_visualization.py::TestMetadataGeneration::test_create_metadata_includes_version PASSED [ 62%]
src/test_large_scale_visualization.py::TestMetadataGeneration::test_create_metadata_includes_parameters PASSED [ 63%]
src/test_large_scale_visualization.py::TestMetadataGeneration::test_create_metadata_includes_grid_size PASSED [ 63%]
src/test_large_scale_visualization.py::TestMetadataGeneration::test_create_metadata_optional_parameters PASSED [ 63%]
src/test_large_scale_visualization.py::TestMetadataSaving::test_save_metadata_creates_file PASSED [ 64%]
src/test_large_scale_visualization.py::TestMetadataSaving::test_save_metadata_valid_json PASSED [ 64%]
src/test_large_scale_visualization.py::TestMetadataSaving::test_save_metadata_pretty_printed PASSED [ 64%]
src/test_large_scale_visualization.py::TestMetadataSaving::test_save_and_load_metadata_roundtrip PASSED [ 64%]
src/test_large_scale_visualization.py::TestDatasetValidation::test_validate_dataset_valid_corpus PASSED [ 65%]
src/test_large_scale_visualization.py::TestDatasetValidation::test_validate_dataset_checks_shape PASSED [ 65%]
src/test_large_scale_visualization.py::TestDatasetValidation::test_validate_dataset_checks_dtype PASSED [ 65%]
src/test_large_scale_visualization.py::TestDatasetValidation::test_validate_dataset_checks_value_range PASSED [ 66%]
src/test_large_scale_visualization.py::TestDatasetValidation::test_validate_dataset_returns_tuple PASSED [ 66%]
src/test_large_scale_visualization.py::TestDatasetValidation::test_validate_dataset_with_splits PASSED [ 66%]
src/test_large_scale_visualization.py::TestUint8Visualization::test_save_corpus_preserves_uint8 PASSED [ 67%]
src/test_large_scale_visualization.py::TestUint8Visualization::test_save_corpus_uint8_space_efficiency PASSED [ 67%]
src/test_large_scale_visualization.py::TestUint8Visualization::test_load_corpus_handles_uint8 PASSED [ 67%]
src/test_large_scale_visualization.py::TestIntegration::test_full_workflow_with_metadata PASSED [ 68%]
src/test_large_scale_visualization.py::TestIntegration::test_1k_dataset_workflow PASSED [ 68%]
src/test_large_scale_visualization.py::TestIntegration::test_metadata_includes_all_required_fields PASSED [ 68%]
src/test_pipeline.py::TestImageGenerator::test_image_generator_creates_grid PASSED [ 68%]
src/test_pipeline.py::TestImageGenerator::test_image_has_1_to_4_objects PASSED [ 69%]
src/test_pipeline.py::TestImageGenerator::test_specific_object_count PASSED [ 69%]
src/test_pipeline.py::TestImageGenerator::test_objects_use_different_colors PASSED [ 69%]
src/test_pipeline.py::TestImageGenerator::test_objects_dont_overlap PASSED [ 70%]
src/test_pipeline.py::TestImageGenerator::test_random_object_count_range PASSED [ 70%]
src/test_pipeline.py::TestImageGenerator::test_object_type_distribution PASSED [ 70%]
src/test_pipeline.py::TestMultiObjectPlacement::test_two_objects_dont_overlap PASSED [ 71%]
src/test_pipeline.py::TestMultiObjectPlacement::test_four_objects_placement PASSED [ 71%]
src/test_pipeline.py::TestMultiObjectPlacement::test_objects_have_valid_sizes PASSED [ 71%]
src/test_pipeline.py::TestRetryLogic::test_generator_handles_placement_failures PASSED [ 72%]
src/test_pipeline.py::TestRetryLogic::test_partial_placement_accepted PASSED [ 72%]
src/test_pipeline.py::TestCorpusGeneration::test_generate_corpus_default_size PASSED [ 72%]
src/test_pipeline.py::TestCorpusGeneration::test_generate_corpus_custom_size PASSED [ 72%]
src/test_pipeline.py::TestCorpusGeneration::test_corpus_contains_grids PASSED [ 73%]
src/test_pipeline.py::TestCorpusGeneration::test_corpus_images_are_different PASSED [ 73%]
src/test_pipeline.py::TestCorpusGeneration::test_corpus_all_valid PASSED [ 73%]
src/test_pipeline.py::TestTrainValTestSplit::test_split_corpus_returns_three_sets PASSED [ 74%]
src/test_pipeline.py::TestTrainValTestSplit::test_split_corpus_80_10_10 PASSED [ 74%]
src/test_pipeline.py::TestTrainValTestSplit::test_split_corpus_no_duplicates PASSED [ 74%]
src/test_pipeline.py::TestTrainValTestSplit::test_split_corpus_small_size PASSED [ 75%]
src/test_pipeline.py::TestTrainValTestSplit::test_split_preserves_all_images PASSED [ 75%]
src/test_pipeline.py::TestIntegration::test_end_to_end_generation PASSED [ 75%]
src/test_pipeline.py::TestIntegration::test_pipeline_reproducibility_with_seed PASSED [ 76%]
src/test_pipeline.py::TestIntegration::test_large_corpus_generation PASSED [ 76%]
src/test_pipeline.py::TestIntegration::test_pipeline_with_different_object_counts PASSED [ 76%]
src/test_shape_generators.py::TestRectangleGenerator::test_rectangle_generator_creates_object PASSED [ 76%]
src/test_shape_generators.py::TestRectangleGenerator::test_rectangle_is_filled PASSED [ 77%]
src/test_shape_generators.py::TestRectangleGenerator::test_rectangle_respects_size_constraints PASSED [ 77%]
src/test_shape_generators.py::TestRectangleGenerator::test_rectangle_dimensions_within_range PASSED [ 77%]
src/test_shape_generators.py::TestRectangleGenerator::test_rectangle_variability PASSED [ 78%]
src/test_shape_generators.py::TestRectangleGenerator::test_rectangle_default_constraints PASSED [ 78%]
src/test_shape_generators.py::TestRectangleGenerator::test_small_rectangle PASSED [ 78%]
src/test_shape_generators.py::TestRectangleGenerator::test_square_rectangle PASSED [ 79%]
src/test_shape_generators.py::TestLineGenerator::test_line_generator_creates_object PASSED [ 79%]
src/test_shape_generators.py::TestLineGenerator::test_horizontal_line PASSED [ 79%]
src/test_shape_generators.py::TestLineGenerator::test_vertical_line PASSED [ 80%]
src/test_shape_generators.py::TestLineGenerator::test_diagonal_line PASSED [ 80%]
src/test_shape_generators.py::TestLineGenerator::test_line_respects_length_constraints PASSED [ 80%]
src/test_shape_generators.py::TestLineGenerator::test_line_respects_size_constraints PASSED [ 80%]
src/test_shape_generators.py::TestLineGenerator::test_random_direction_selection PASSED [ 81%]
src/test_shape_generators.py::TestLineGenerator::test_line_minimum_length PASSED [ 81%]
src/test_shape_generators.py::TestPatternGenerator::test_pattern_generator_creates_object PASSED [ 81%]
src/test_shape_generators.py::TestPatternGenerator::test_checkerboard_pattern PASSED [ 82%]
src/test_shape_generators.py::TestPatternGenerator::test_l_shape_pattern PASSED [ 82%]
src/test_shape_generators.py::TestPatternGenerator::test_t_shape_pattern PASSED [ 82%]
src/test_shape_generators.py::TestPatternGenerator::test_plus_pattern PASSED [ 83%]
src/test_shape_generators.py::TestPatternGenerator::test_zigzag_pattern PASSED [ 83%]
src/test_shape_generators.py::TestPatternGenerator::test_random_pattern_selection PASSED [ 83%]
src/test_shape_generators.py::TestPatternGenerator::test_all_patterns_valid_size PASSED [ 84%]
src/test_shape_generators.py::TestPatternGenerator::test_pattern_types_available PASSED [ 84%]
src/test_shape_generators.py::TestSizeConstraintsAllGenerators::test_rectangle_meets_constraints PASSED [ 84%]
src/test_shape_generators.py::TestSizeConstraintsAllGenerators::test_line_meets_constraints PASSED [ 84%]
src/test_shape_generators.py::TestSizeConstraintsAllGenerators::test_pattern_meets_constraints PASSED [ 85%]
src/test_shape_generators.py::TestSizeConstraintsAllGenerators::test_no_objects_too_small PASSED [ 85%]
src/test_shape_generators.py::TestSizeConstraintsAllGenerators::test_no_objects_too_large PASSED [ 85%]
src/test_shape_generators.py::TestIntegration::test_all_generators_produce_objects PASSED [ 86%]
src/test_shape_generators.py::TestIntegration::test_generators_produce_variety PASSED [ 86%]
src/test_visual_validation.py::TestSampleSelection::test_select_random_samples_basic PASSED [ 86%]
src/test_visual_validation.py::TestSampleSelection::test_select_random_samples_with_seed PASSED [ 87%]
src/test_visual_validation.py::TestSampleSelection::test_select_random_samples_returns_indices PASSED [ 87%]
src/test_visual_validation.py::TestSampleSelection::test_select_random_samples_fewer_than_requested PASSED [ 87%]
src/test_visual_validation.py::TestGridVisualization::test_create_validation_grid_10x10 PASSED [ 88%]
src/test_visual_validation.py::TestGridVisualization::test_create_validation_grid_returns_figure PASSED [ 88%]
src/test_visual_validation.py::TestGridVisualization::test_create_validation_grid_with_metadata PASSED [ 88%]
src/test_visual_validation.py::TestGridVisualization::test_create_validation_grid_handles_partial_samples PASSED [ 88%]
src/test_visual_validation.py::TestMetadataOverlay::test_add_metadata_overlay_basic PASSED [ 89%]
src/test_visual_validation.py::TestMetadataOverlay::test_metadata_includes_sample_indices PASSED [ 89%]
src/test_visual_validation.py::TestVisualStatistics::test_compute_visual_statistics_basic PASSED [ 89%]
src/test_visual_validation.py::TestVisualStatistics::test_compute_visual_statistics_ranges PASSED [ 90%]
src/test_visual_validation.py::TestVisualStatistics::test_compute_visual_statistics_uint8 PASSED [ 90%]
src/test_visual_validation.py::TestVisualStatistics::test_visual_statistics_on_grid PASSED [ 90%]
src/test_visual_validation.py::TestPNGExport::test_save_validation_grid_creates_file PASSED [ 91%]
src/test_visual_validation.py::TestPNGExport::test_save_validation_grid_file_size PASSED [ 91%]
src/test_visual_validation.py::TestPNGExport::test_save_validation_grid_with_dpi PASSED [ 91%]
src/test_visual_validation.py::TestEndToEndValidation::test_full_validation_workflow PASSED [ 92%]
src/test_visual_validation.py::TestEndToEndValidation::test_validation_with_dataset_directory PASSED [ 92%]
src/test_visual_validation.py::TestEndToEndValidation::test_validation_includes_all_components PASSED [ 92%]
src/test_visualization.py::TestARCColorScheme::test_arc_colormap_has_10_colors PASSED [ 92%]
src/test_visualization.py::TestARCColorScheme::test_arc_colormap_includes_background PASSED [ 93%]
src/test_visualization.py::TestARCColorScheme::test_arc_colormap_valid_hex PASSED [ 93%]
src/test_visualization.py::TestGridVisualization::test_visualize_grid_accepts_grid PASSED [ 93%]
src/test_visualization.py::TestGridVisualization::test_visualize_grid_accepts_numpy_array PASSED [ 94%]
src/test_visualization.py::TestGridVisualization::test_visualize_grid_with_title PASSED [ 94%]
src/test_visualization.py::TestGridVisualization::test_visualize_grid_returns_figure PASSED [ 94%]
src/test_visualization.py::TestGalleryVisualization::test_visualize_gallery_single_grid PASSED [ 95%]
src/test_visualization.py::TestGalleryVisualization::test_visualize_gallery_multiple_grids PASSED [ 95%]
src/test_visualization.py::TestGalleryVisualization::test_visualize_gallery_custom_layout PASSED [ 95%]
src/test_visualization.py::TestGalleryVisualization::test_visualize_gallery_with_titles PASSED [ 96%]
src/test_visualization.py::TestNPZSerialization::test_save_corpus_creates_file PASSED [ 96%]
src/test_visualization.py::TestNPZSerialization::test_save_corpus_with_splits PASSED [ 96%]
src/test_visualization.py::TestNPZSerialization::test_load_corpus_returns_dict PASSED [ 96%]
src/test_visualization.py::TestNPZSerialization::test_save_and_load_corpus PASSED [ 97%]
src/test_visualization.py::TestNPZSerialization::test_save_and_load_with_splits PASSED [ 97%]
src/test_visualization.py::TestOutputFormat::test_corpus_array_shape PASSED [ 97%]
src/test_visualization.py::TestOutputFormat::test_corpus_array_dtype FAILED [ 98%]
src/test_visualization.py::TestOutputFormat::test_corpus_values_in_range PASSED [ 98%]
src/test_visualization.py::TestOutputFormat::test_compression_reduces_size PASSED [ 98%]
src/test_visualization.py::TestEndToEndIntegration::test_generate_visualize_save_load PASSED [ 99%]
src/test_visualization.py::TestEndToEndIntegration::test_reproducible_pipeline PASSED [ 99%]
src/test_visualization.py::TestEndToEndIntegration::test_large_corpus_workflow PASSED [ 99%]
src/test_visualization.py::TestEndToEndIntegration::test_visualize_loaded_corpus PASSED [100%]

=================================== FAILURES ===================================
_______________________ TestCLIIntegration.test_cli_help _______________________
src/test_integration.py:108: in test_cli_help
    assert result.returncode == 0
E   assert 2 == 0
E    +  where 2 = CompletedProcess(args=['python', 'generate_dataset.py', '--help'], returncode=2, stdout='', stderr="python: can't open file '/Users/thomas/Projects/hackathon/research-os/project/generate_dataset.py': [Errno 2] No such file or directory\n").returncode
______________ TestCLIIntegration.test_cli_with_custom_parameters ______________
src/test_integration.py:142: in test_cli_with_custom_parameters
    assert result.returncode == 0
E   assert 2 == 0
E    +  where 2 = CompletedProcess(args=['python', 'generate_dataset.py', '--num-images', '10', '--output-dir', '/var/folders/bz/g07tjmm155s9dhfgfhcg2dqr0000gn/T/tmpbjo_dtt1/custom-dataset', '--seed', '999'], returncode=2, stdout='', stderr="python: can't open file '/Users/thomas/Projects/hackathon/research-os/project/generate_dataset.py': [Errno 2] No such file or directory\n").returncode
__________ TestVisualValidationIntegration.test_visual_validation_cli __________
src/test_integration.py:340: in test_visual_validation_cli
    assert result.returncode == 0
E   assert 2 == 0
E    +  where 2 = CompletedProcess(args=['python', 'validate_visual.py', '--corpus-path', '/var/folders/bz/g07tjmm155s9dhfgfhcg2dqr0000gn/T/tmpuon7_dbs/corpus.npz', '--metadata-path', '/var/folders/bz/g07tjmm155s9dhfgfhcg2dqr0000gn/T/tmpuon7_dbs/metadata.json', '--output', '/var/folders/bz/g07tjmm155s9dhfgfhcg2dqr0000gn/T/tmpuon7_dbs/validation.png', '--seed', '42'], returncode=2, stdout='', stderr="python: can't open file '/Users/thomas/Projects/hackathon/research-os/project/validate_visual.py': [Errno 2] No such file or directory\n").returncode
___________________ TestOutputFormat.test_corpus_array_dtype ___________________
src/test_visualization.py:210: in test_corpus_array_dtype
    assert loaded['images'].dtype in [np.int32, np.int64]
E   AssertionError: assert dtype('uint8') in [<class 'numpy.int32'>, <class 'numpy.int64'>]
E    +  where dtype('uint8') = array([[[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],\n\n       [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, ... 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],\n\n       [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 7, 7, 0, 0, 2, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 7, 7, 0, 2, 2, 2, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 7, 7, 2, 2, 2, 2, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 7, 7, 0, 2, 2, 2, 2, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]], dtype=uint8).dtype
=============================== warnings summary ===============================
src/test_integration.py:371
  /Users/thomas/Projects/hackathon/research-os/project/src/test_integration.py:371: PytestUnknownMarkWarning: Unknown pytest.mark.slow - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.slow

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED src/test_integration.py::TestCLIIntegration::test_cli_help - assert 2 ...
FAILED src/test_integration.py::TestCLIIntegration::test_cli_with_custom_parameters
FAILED src/test_integration.py::TestVisualValidationIntegration::test_visual_validation_cli
FAILED src/test_visualization.py::TestOutputFormat::test_corpus_array_dtype
================== 4 failed, 321 passed, 1 warning in 56.75s ===================
